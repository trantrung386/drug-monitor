<%- include('includes/_header') %>

<main id="main">
  <h2 style="text-align:center; margin-bottom: 20px;">Update Drug</h2>

  <form id="updateDrugForm" style="max-width: 500px; margin: 0 auto; display: flex; flex-direction: column; gap: 15px;">
    <input type="hidden" id="id" value="<%= drug._id %>">

    <label>Name</label>
    <input type="text" id="name" value="<%= drug.name %>" required>

    <label>Tablets per Card</label>
    <input type="number" id="card" value="<%= drug.card %>" required>

    <label>Tablets per Pack</label>
    <input type="number" id="pack" value="<%= drug.pack %>" required>

    <label>Taken per Day</label>
    <input type="number" id="perDay" value="<%= drug.perDay %>" required>

    <label>Daily Dosage</label>
    <input type="text" id="dosage" value="<%= drug.dosage %>" required>

    <button type="submit" style=" background:#999b9d; color:#fff; border:none; border-radius:5px; ">
      Update
    </button>
  </form>
</main>

<script>
  document.getElementById("updateDrugForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const id = document.getElementById("id").value;

    const body = {
      name: document.getElementById("name").value,
      card: document.getElementById("card").value,
      pack: document.getElementById("pack").value,
      perDay: document.getElementById("perDay").value,
      dosage: document.getElementById("dosage").value,
    };

    const res = await fetch(`/api/drugs/${id}`, {
      method: "PUT",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(body),
    });

    const data = await res.json();
    alert(data.message || "Updated successfully!");
    window.location.href = "/manage";
  });
</script>

<%- include('includes/_footer') %>
